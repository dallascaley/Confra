- name: Breakroom EC2 Setup
  hosts: breakroom
  become: true
  tasks:
    - name: Ensure Python 3 is installed (redundant, but safe)
      yum:
        name: python3
        state: present

    - name: Enable NGINX via amazon-linux-extras
      command: amazon-linux-extras enable nginx1
      args:
        creates: /etc/yum.repos.d/amzn2-extras.repo  # avoid running every time

    - name: Install NGINX
      yum:
        name: nginx
        state: present

    - name: Start NGINX service
      service:
        name: nginx
        state: started
        enabled: true

    - name: Install Docker
      yum:
        name: docker
        state: present

    - name: Start and enable Docker service
      service:
        name: docker
        state: started
        enabled: true

    - name: Add ec2-user to docker group
      user:
        name: ec2-user
        groups: docker
        append: yes

